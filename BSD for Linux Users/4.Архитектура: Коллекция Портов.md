**Коллекция Портов**

После "базовой системы" в мире BSD существует вторая категория программ. Это те программы, которые являются дополнительными пакетами и называются «коллекцией портов». Это имя выбрано по определенной причине.

Традиционно, когда вы хотели запустить пакет в своей системе, первое, что вам нужно было сделать, это скомпилировать его. И часто, прежде чем вы сможете скомпилировать его, вам придется возиться с ним. Вашей системе потребуются другие файлы и библиотеки. Иногда все гораздо сложнее, и вам даже нужно внести измненения в программный код устанавливаемого пакета.

Или, другими словами, вам придется «портировать» его на свою ОС и/или на конкретную систему. Основная цель "коллекции портов" состоит в том, чтобы сделать все эти «портирующие» вещи для вас. В то же время "коллекция портов" также автоматизирует сборку, установку и удаление, но это не так хорошо отражено в названии.

В текущей коллекции портов FreeBSD содержится около 10 000 пакетов (это число, конечно, быстро устареет, но такова природа разработки). Самая очевидная особенность "коллекции портов" заключается в том, что установка пакетов происходит из исходного кода, а не просто из предварительно собранных файлов. Это, похоже, еще одно явное различие, которое сбивает людей с толку, когда они пытаются взглянуть на BSD с точки зрения Linux. То, что пакеты из "коллекции портов" строятся из исходного кода, является просто побочным эффектом, а не основной целью или различием. Бинарные пакеты также доступны, фактически бинарные пакеты создаются из "коллекции портов"!

Большинство пользователей Linux устанавливают бинарные пакеты, а большинство пользователей BSD с помощью сборки из исходного кода. "Коллекция портов" разработана на основе концепции сборки из исходного кода, но так же с возможностью создания и установки бинарных пакетов, в то время как пакеты Linux, такие как RPM и dpkg и т. д., основаны на концепции установки бинарного пакета. Так исторически сложилось, что установка бинарных пакетов не является доминирующей в системах Unix и является в этом плане новшеством.

Gentoo - это дистрибутив Linux довольно популярный в наши дни. Одним из главных его преимуществ является система портежей, которая часто считается очень похожей на "коллекцию портов" BSD. В Gentoo пакеты также компилируется из исходного кода, что позволяет избежать многих проблем. Я никогда не использовал этот дистрибутив, но впечатления, которые я получил от людей, использующих его, это то, что в нем собраны идеи от разных систем. Будет очень интересно посмотреть, как он будет продолжать развиваться в течение следующих лет. Конечно, Gentoo это все еще намного больше Linux, чем BSD, но больше всех из других популярных дистрибутов Linux соответствует стилю BSD.

У бинарных пакетов есть свои преимущества, в основном это меньшее время для установки и меньшее требование к свободному  месту, по сравнению с установкой из исходного кода. С другой стороны, у сборки из исходного кода тоже есть преимущества, например, избегание всякого рода нестандартных версий библиотек (моя личная больная мозоль с бинарными пакетами). Не смотря на то, что вы можете установить бинарные пакеты как на Linux так и на BSD, вы так же можете собрать эти же пакеты из исходного кода как Linux так на и BSD.

Я думаю, здесь важно понять, что разница между портами и бинарными пакетами заключается не только в том, что порты компилируются, а последние просто устанавливаются. Порты спроектированы таким образом, чтобы охватывать варианты и детали установки; кодирование, отслеживание и установка зависимостей, установка и удаление, локальные изменения, необходимые для сборки в вашей системе, настройки во время компиляции и тому подобное. RPM - это просто бинарный пакет. Если вы хотите автоматически устанавливать зависимости, вам нужен высокоуровневый инструмент, например, dnf или apt-get. При использовании бинарных файлов, вам приходится иметь дело с конфликтами версий библиотек, отсутствующими опциями компиляции или любыми другими ограничениями, которые возникают у вас из-за того, что пакет был собран не в вашей собственной системе.

Кроме того, порты, как и остальные интсрументы BSD, централизованы. «Коллекция портов» на самом деле представляет собой просто большое дерево с кучей категоризированных каталогов, каждое из которых содержит Makefile с некоторыми определениями переменных, файл контрольной суммы, список упаковки и другие компоненты. Каждый из этих каталогов представляет собой отдельную программу, которая описывается имеющимися файлами. За кулисами происходит куча черной магии, так что когда вы запускаете make, он находит и загружает дистрибутивный файл, где бы он ни находился, вносит любые необходимые изменения или исправления, рекурсивно находит и устанавливает все зависимости, вызывает GNU configure или imake или что-то другое, что необходимо для подготовки программы к установке, запускает компиляцию с правильными параметрами и т. д.

Но все эти файлы в этом большом дереве каталогов поддерживаются самим проектом FreeBSD. Например, когда был разработан KDE, он не сразу появлялся в "коллекции портов". Кто-то должен был переработать этот пакет, чтобы построить для него порт, а затем зафиксировать файлы в репозитории FreeBSD CVS, чтобы он появился в "коллекции портов". Поэтому, еще раз, есть некоторые гарантии того, что KDE  будет работать с другими пакетами из "коллекции портов". Любые зависимости, которые у него есть, будут там, потому что он не может ссылаться на зависимость, которой нет в "коллекции портов".

С другой стороны, вещи имеют свойство ломаться. Возможно, у основного сайта исчезнет зависимость, поэтому никто не сможет скачать исходный файл и начать его установку. Возможно, новая версия какой-то третьей программы сломает программу, что не позволит другим пакетам, которые зависят от нее, работать. Конечно, это не решает всех проблем. Но частота «я хочу A, для которого требуется B, которого я не могу найти», намного меньше, чем в таких системах, как RPM.

За более детальной информацией (впрочем, как всегда), следует обратиться к [Руководству FreeBSD](https://www.freebsd.org/doc/ru/books/handbook/).
